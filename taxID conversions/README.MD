For gi --> taxID --> taxonomic lineage, ncbi databases will be needed. They can be downloaded from the ncbi ftp server, here ftp://ftp.ncbi.nih.gov/pub/taxonomy/

Files needed for the code I've posted are: gi_taxid_prot.dmp, names.dmp, and nodes.dmp

User-created files (tab-delimited, one column, one item per line, no header) needed are:an input file of gi numbers and an input file of taxIDs